<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.15.3/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.15.3/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.15.3/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root, jsonOptions) => {
          const markmap = getMarkmap();
          window.mm = markmap.Markmap.create('svg#mindmap', (getOptions || markmap.deriveOptions)(jsonOptions), root);
        })(() => window.markmap,null,{"type":"heading","depth":0,"payload":{"lines":[0,1]},"content":"day13-事务-AOP","children":[{"type":"heading","depth":1,"payload":{"lines":[2,3]},"content":"事务","children":[{"type":"heading","depth":2,"payload":{"lines":[4,5]},"content":"1.保证一组操作要么同时成功或者同时失败","children":[]},{"type":"heading","depth":2,"payload":{"lines":[6,7]},"content":"2.三个操作","children":[{"type":"list_item","depth":3,"payload":{"lines":[8,9]},"content":"开启事务","children":[{"type":"list_item","depth":4,"payload":{"lines":[10,11]},"content":"start transaction;","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[12,13]},"content":"提交事务","children":[{"type":"list_item","depth":4,"payload":{"lines":[14,15]},"content":"commit;","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[16,17]},"content":"回滚事务","children":[{"type":"list_item","depth":4,"payload":{"lines":[18,19]},"content":"rollback;","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[20,21]},"content":"没有boot的时候","children":[{"type":"list_item","depth":4,"payload":{"lines":[22,31]},"content":"try{<br>\n//1.开启事务<br>\n操作1;<br>\n操作2;<br>\n....<br>\n//2.提交事务<br>\n}catch(Exception e){<br>\n//3.回滚事务<br>\n}","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[32,33]},"content":"有boot的时候","children":[{"type":"list_item","depth":4,"payload":{"lines":[34,35]},"content":"只需要挂@Transactional这个注解即可","children":[{"type":"list_item","depth":5,"payload":{"lines":[36,37]},"content":"声明式事务, 声明个注解事务就会被管理","children":[]},{"type":"list_item","depth":5,"payload":{"lines":[37,38]},"content":"rollbackFor","children":[{"type":"list_item","depth":6,"payload":{"lines":[39,40]},"content":"boot仅仅帮你在runtime异常回滚","children":[]}]},{"type":"list_item","depth":5,"payload":{"lines":[41,42]},"content":"propagation","children":[{"type":"list_item","depth":6,"payload":{"lines":[43,44]},"content":"事务的传播行为","children":[]},{"type":"list_item","depth":6,"payload":{"lines":[44,45]},"content":"REQUIRED(默认值)","children":[{"type":"list_item","depth":7,"payload":{"lines":[46,47]},"content":"需要事务, 如果有加入, 没有则创建新的","children":[]}]},{"type":"list_item","depth":6,"payload":{"lines":[48,49]},"content":"REQUIRES_NEW","children":[{"type":"list_item","depth":7,"payload":{"lines":[50,51]},"content":"需要事务, 不管有没有都创建新的","children":[]}]}]}]},{"type":"list_item","depth":4,"payload":{"lines":[52,53]},"content":"boot帮我们try catch","children":[]}]}]},{"type":"heading","depth":2,"payload":{"lines":[54,55]},"content":"注意事项","children":[{"type":"list_item","depth":3,"payload":{"lines":[56,57]},"content":"boot只会帮我们回滚运行时异常,  我们想要回滚编译时异常需要添加rollbackFor= 异常类型,   我们告诉boot什么异常要回滚!!!!!","children":[]}]}]},{"type":"heading","depth":1,"payload":{"lines":[58,59]},"content":"AOP","children":[{"type":"heading","depth":2,"payload":{"lines":[60,61]},"content":"概念","children":[{"type":"list_item","depth":3,"payload":{"lines":[62,63]},"content":"面向切面编程;(对已经存在的代码功能进行增强控制的技术)","children":[]},{"type":"list_item","depth":3,"payload":{"lines":[63,64]},"content":"相关名词","children":[{"type":"list_item","depth":4,"payload":{"lines":[65,66]},"content":"目标对象","children":[{"type":"list_item","depth":5,"payload":{"lines":[67,68]},"content":"我们希望增强的类;(原来项目中已经存在的功能类)","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[69,70]},"content":"连接点","children":[{"type":"list_item","depth":5,"payload":{"lines":[71,72]},"content":"目标对象中的任意一个方法都是一个连接点;","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[73,74]},"content":"切入点","children":[{"type":"list_item","depth":5,"payload":{"lines":[75,76]},"content":"符合切入点表达式的连接点就是切入点;","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[77,78]},"content":"切入点表达式","children":[{"type":"list_item","depth":5,"payload":{"lines":[79,80]},"content":"描述什么样的连接点有资格成为切入点的字符串表达式;","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[81,82]},"content":"通知","children":[{"type":"list_item","depth":5,"payload":{"lines":[83,84]},"content":"我们新增的对目标对象中的功能进行增强的逻辑(就是我们自定义的增强逻辑的方法);","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[85,86]},"content":"切面","children":[{"type":"list_item","depth":5,"payload":{"lines":[87,88]},"content":"描述切入点和通知之间的联合关系的动作就是切面;(这个是重点)","children":[]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[89,90]},"content":"作用:","children":[{"type":"list_item","depth":3,"payload":{"lines":[91,92]},"content":"可以在不改变原码的情况下对功能进行增强","children":[]}]},{"type":"heading","depth":2,"payload":{"lines":[93,94]},"content":"原理","children":[{"type":"list_item","depth":3,"payload":{"lines":[95,96]},"content":"基于动态代理完成的","children":[{"type":"list_item","depth":4,"payload":{"lines":[97,98]},"content":"JDK动态代理","children":[{"type":"list_item","depth":5,"payload":{"lines":[99,100]},"content":"缺点: 只能面向接口编程","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[101,102]},"content":"CGLIB代理","children":[{"type":"list_item","depth":5,"payload":{"lines":[103,104]},"content":"可以面向类带来, 本质造了一个类的子类","children":[]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[105,106]},"content":"切面","children":[{"type":"list_item","depth":3,"payload":{"lines":[107,108]},"content":"@Asepct注解标注是一个切面类","children":[]},{"type":"list_item","depth":3,"payload":{"lines":[108,109]},"content":"通知的类型","children":[{"type":"list_item","depth":4,"payload":{"lines":[110,111]},"content":"虽然有很多, 但是最后只用一个@Around","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[112,113]},"content":"切点表达式","children":[{"type":"list_item","depth":4,"payload":{"lines":[114,115]},"content":"execution","children":[{"type":"list_item","depth":5,"payload":{"lines":[116,117]},"content":"..","children":[{"type":"list_item","depth":6,"payload":{"lines":[118,119]},"content":"匹配任意层级或者任意个数的内容","children":[]}]},{"type":"list_item","depth":5,"payload":{"lines":[120,124]},"content":"","children":[{"type":"list_item","depth":6,"payload":{"lines":[122,123]},"content":"匹配单个目录, 类, 方法, 单个参数","children":[]}]},{"type":"list_item","depth":5,"payload":{"lines":[124,125]},"content":"习惯","children":[{"type":"list_item","depth":6,"payload":{"lines":[126,127]},"content":"包结构慎用..","children":[]},{"type":"list_item","depth":6,"payload":{"lines":[127,128]},"content":"尽量给接口添加aop","children":[]},{"type":"list_item","depth":6,"payload":{"lines":[128,129]},"content":"读表达式从右往左读","children":[]}]}]},{"type":"list_item","depth":4,"payload":{"lines":[130,131]},"content":"@annotation","children":[{"type":"list_item","depth":5,"payload":{"lines":[132,133]},"content":"1: 自定义一个注解","children":[]},{"type":"list_item","depth":5,"payload":{"lines":[133,134]},"content":"2: 描述带有指定注解的方法可以作为切入点","children":[]}]},{"type":"list_item","depth":4,"payload":{"lines":[135,136]},"content":"对比","children":[{"type":"list_item","depth":5,"payload":{"lines":[137,138]},"content":"execution 的通用性更强,可以做到,写1次,匹配多个方法;","children":[]},{"type":"list_item","depth":5,"payload":{"lines":[138,139]},"content":"annotation 可以精确到具体的某个方法,如果方法之间没有规律,或需要增强的方法数量较少,可以采用这种方式;","children":[]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[140,141]},"content":"练习","children":[{"type":"list_item","depth":3,"payload":{"lines":[142,143]},"content":"1.思考如何对所有请求参数进行去除前后空格","children":[]},{"type":"list_item","depth":3,"payload":{"lines":[143,144]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[143,144],"index":2},"content":"2. 统计业务层每个方法执行的时间","children":[]}]},{"type":"list_item","depth":3,"payload":{"lines":[144,145]},"content":"3: 完成课堂的解散部门的日志记录功能和最后的操作记录功能;","children":[]}]}]}]},{})</script>
</body>
</html>
